(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[103],{1103:function(e,t,r){"use strict";r.d(t,{Z:function(){return Fe}});var i,n=r(9156),o=r(5366),s=r(7294),a=r(7788),c=r(1721),l=function(){var e=(0,c.pG)("page.scroll").maxScrollY,t=(0,s.useState)(),r=t[0],i=t[1],n=r/e,o=n>1?1:n;return(0,s.useEffect)((function(){window.addEventListener("scroll",(function(e){i(window.scrollY)}))}),[]),r?o:0},u=r(1380),h=r(3359),f=r(6360),p=r(5103),d=r(5944),g=r(8347),b=r(7433),v=r(9510),y=r(4121),m=function(e,t,r){return t+(e-t)*r},x=function(e,t){var r=e-t;return Math.random()*r+t},w=function e(t,r,i,n){var o=x(t,r);return o>n&&o<i?e(t,r,i,n):o},R=function(){return Math.round(x.apply(void 0,arguments))},P=r(6265),Z=r(7704),E=r(2212),S=r(6493),O=(new E.Color("#73a1f1"),new E.Color("#dbf1f0"),new E.Vector3(100.01,100.01,100.01),{vertexShader:"\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = vec4( position, 1.0 );    \n  }\n",fragmentShader:"\n  varying vec2 vUv;\n  uniform vec2 resolution;\n  uniform vec3 sunDirection;\n  uniform float fogFade;\n  uniform float fov;\n\n  //Darken sky when looking up\n  \n  const vec3 skyColour = 0.6 * vec3(0.02, 0.2, 0.9);\n  vec3 getSkyColour(vec3 rayDir){\n    return mix(0.35*skyColour, skyColour, pow(1.0-rayDir.y, 4.0));\n  }\n\n  //https://iquilezles.org/www/articles/fog/fog.htm\n  vec3 applyFog(vec3 rgb, vec3 rayOri, vec3 rayDir, vec3 sunDir){\n    //Make horizon more hazy\n    float dist = 4000.0;\n    if(abs(rayDir.y) < 0.0001){rayDir.y = 0.0001;}\n    float fogAmount = 1.0 * exp(-rayOri.y*fogFade) * (1.0-exp(-dist*rayDir.y*fogFade))/rayDir.y;\n    float sunAmount = max( dot( rayDir, sunDir ), 0.0 );\n    vec3 fogColor  = mix(vec3(0.35, 0.5, 0.9), vec3(1.0, 1.0, 0.75), pow(sunAmount, 16.0) );\n  return mix(rgb, fogColor, clamp(fogAmount, 0.0, 1.0));\n  }\n\n  vec3 ACESFilm(vec3 x){\n    float a = 2.51;\n    float b = 0.03;\n    float c = 2.43;\n    float d = 0.59;\n    float e = 0.14;\n    return clamp((x*(a*x+b))/(x*(c*x+d)+e), 0.0, 1.0);\n  }\n\n  vec3 rayDirection(float fieldOfView, vec2 fragCoord) {\n    vec2 xy = fragCoord - resolution.xy / 2.0;\n    float z = (0.5 * resolution.y) / tan(radians(fieldOfView) / 2.0);\n    return normalize(vec3(xy, -z));\n  }\n\n  //https://www.geertarien.com/blog/2017/07/30/breakdown-of-the-lookAt-function-in-OpenGL/\n  mat3 lookAt(vec3 camera, vec3 at, vec3 up){\n    vec3 zaxis = normalize(at-camera);    \n    vec3 xaxis = normalize(cross(zaxis, up));\n    vec3 yaxis = cross(xaxis, zaxis);\n\n    return mat3(xaxis, yaxis, -zaxis);\n  }\n\n  float getGlow(float dist, float radius, float intensity){\n    dist = max(dist, 1e-6);\n    return pow(radius/dist, intensity);\t\n  }\n\n  void main() {\n\n    vec3 target = vec3(0.0, 0.0, 0.0);\n    vec3 up = vec3(0.0, 1.0, 0.0);\n    vec3 rayDir = rayDirection(fov, gl_FragCoord.xy);\n\n    //Get the view matrix from the camera orientation\n    mat3 viewMatrix_ = lookAt(cameraPosition, target, up);\n\n    //Transform the ray to point in the correct direction\n    rayDir = viewMatrix_ * rayDir;\n\n    vec3 col = getSkyColour(rayDir);\n\n    //Draw sun\n    vec3 sunDir = normalize(sunDirection);\n    float mu = dot(sunDir, rayDir);\n    col += vec3(1.0, 1.0, 0.8) * getGlow(1.0-mu, 0.00005, 0.9);\n\n    col += applyFog(col, vec3(0,1000,0), rayDir, sunDir);\n\n    //Tonemapping\n    col = ACESFilm(col);\n\n    //Gamma correction 1.0/2.2 = 0.4545...\n    col = pow(col, vec3(0.4545));\n\n    gl_FragColor = vec4(col, 1.0 );\n  }\n"});function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){(0,P.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var z,j,D,L=function(){var e=(0,Z.Z)(),t=function(e,t){return{sunDirection:{type:"vec3",value:new E.Vector3(Math.sin(-0),Math.sin(.02),-Math.cos(-0))},resolution:{type:"vec2",value:new E.Vector2(e,t)},fogFade:{type:"float",value:.005},fov:{type:"float",value:45}}}(e.width,e.height);return(0,n.Z)(S.JO,{args:[2,2,1,1]},void 0,(0,d.tZ)("shaderMaterial",M({attach:"material",side:E.DoubleSide,depthWrite:!1,uniforms:t},O)))};function C(e){var t=.4*e.percentage;return(0,n.Z)("group",{name:"skyGroup",position:[0,0,0],dispose:null},void 0,i||(i=(0,n.Z)(L,{})),(0,n.Z)(S.aL,{args:[495,20,20]},void 0,(0,n.Z)("meshStandardMaterial",{attach:"material",transparent:!0,opacity:t,color:"#2355ad",side:E.DoubleSide,fog:!1})))}var B=function(e){var t=e.percentage,r=(0,s.useRef)(),i=((0,f.pG)("scene.staging.lights.hemi").intensity,(0,f.pG)("scene.staging.lights.point")),o=i.on,a=i.intensityStart,c=i.intensityEnd,l=i.x,u=i.y,h=i.z,p=m(a,c,1-t),g=(0,f.pG)("scene.staging.lights.spot"),b=g.on,v=g.intensity,y=g.near,x=g.far,w=g.fov,R=g.angle,P=g.x,Z=g.y,E=g.z;return(0,s.useEffect)((function(){r.current}),[y,w,x]),(0,d.BX)(d.HY,{children:[z||(z=(0,n.Z)("hemisphereLight",{intensity:.4})),b&&(0,d.tZ)("spotLight",{castShadow:!0,ref:r,penumbra:1,angle:R,intensity:v,position:[P,Z,E],"shadow-mapSize-width":1024,"shadow-mapSize-height":1024}),o&&(0,n.Z)("pointLight",{castShadow:!0,penumbra:1,intensity:p,position:[l,u,h],"shadow-mapSize-width":256,"shadow-mapSize-height":256})]})},X=function(e){var t=e.percentage,r=(0,s.useRef)(),i=(0,f.pG)("scene.staging.camera"),n=i.minPositionY,o=i.maxPositionYDelta,a=i.lookAtYOffset,c=i.minPositionZ,l=i.maxPositionZDelta,h=(0,f.pG)("scene.canvas.controls").on,p=n-a;return(0,s.useEffect)((function(){r.current.lookAt(0,p,0)}),[p,o]),(0,u.xQ)((function(){h||(r.current.position.y=o*t+n,r.current.position.z=l*t+c,r.current.lookAt(0,p,0))})),(0,d.tZ)(b.c,{ref:r,makeDefault:!0,position:[0,n,c]})},Y=function(e){var t=e.percentage,r=(0,f.pG)("scene.staging.fog"),i=r.nearStart,o=r.nearEnd,a=r.farStart,c=r.farEnd,l=r.color,u=(0,f.pG)("scene.staging.sky"),h=(u.sunPositionX,u.sunPositionY,u.minSunPositionZ),p=u.maxSunPositionZ,b=(u.mieCoefficient,(0,g.Z)(u,["sunPositionX","sunPositionY","minSunPositionZ","maxSunPositionZ","mieCoefficient"]),(0,f.pG)("scene.canvas.controls").on),y=(0,s.useRef)(),x=1-t,w=m(i,o,x),R=m(a,c,x);m(h,p,x);return(0,d.BX)(d.HY,{children:[(0,n.Z)(C,{percentage:t}),b&&(j||(j=(0,n.Z)(v.z,{}))),(0,n.Z)("fog",{attach:"fog",args:[l,w,R]}),(0,n.Z)(X,{percentage:t}),(0,d.BX)("mesh",{ref:y,position:[0,10,-10],children:[(0,n.Z)("sphereGeometry",{args:[1,36,36]}),D||(D=(0,n.Z)("meshBasicMaterial",{color:"#00FF00"}))]}),(0,n.Z)(B,{percentage:t})]})},G=r(9999),T=r(3648),V=function(e,t){return(0,s.useMemo)((function(){return R(e,t)}),[e,t])};function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){(0,P.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var A="Clouds";(0,p.QX)(A);var I,W=function(e){var t=e.size,r=e.x,i=e.z,o=e.percentOfMaxZ,a=(0,c.pG)("scene.elements.clouds.cloud"),l=a.segments,u=a.scaleX,h=a.scaleY,f=a.scaleZ,p=(0,s.useMemo)((function(){var e=1*o;return(0,T.CD)(e,"#3798e3","white")}),[o]);return(0,d.tZ)(d.HY,{children:(0,n.Z)(S.aL,{position:[r,0,i],args:[t,l,l],scale:[u,h,f],castShadow:!1,receiveShadow:!1},void 0,(0,n.Z)("meshBasicMaterial",{attach:"material",fog:!1,color:p}))})},F=function(e){var t,r,i=e.x,n=e.y,o=e.z,a=e.resetX,l=e.percentOfMaxZ,h=(0,s.useRef)(),f=(0,c.pG)("scene.elements.clouds.group"),p=f.minCloudNum,g=f.maxCloudNum,b=f.minWidth,v=f.maxWidth,y=f.minLength,m=f.maxLength,w=f.resetCutoffX,R=f.minSpeedX,P=f.maxSpeedX,Z=(0,c.pG)("scene.elements.clouds.cloud"),E=Z.minSize,S=Z.maxSize,O=V(g,p),k=(t=P,r=R,(0,s.useMemo)((function(){return x(t,r)}),[t,r])),M=(0,s.useMemo)((function(){return(0,G.Z)(Array(O)).map((function(){return{size:x(S,E),x:x(v,b),z:x(m,y)}}))}),[O,S,E,v,b,m,y]);return(0,u.xQ)((function(){var e=h.current.position.x;h.current.position.x=e<w?a:e-k})),(0,d.tZ)(d.HY,{children:(0,d.tZ)("group",{ref:h,position:[i,n,o],children:M.map((function(e,t){return(0,d.tZ)(W,N({},N(N({key:t},e),{},{percentOfMaxZ:l})))}))})})},J=function(){(0,p.d0)(A);var e=(0,c.pG)("scene.elements.clouds.clouds"),t=e.minGroupNum,r=e.maxGroupNum,i=(0,c.pG)("scene.elements.clouds.group"),o=i.minPositionX,a=i.minPositionY,l=i.minPositionZ,u=i.maxPositionX,h=i.maxPositionY,f=i.maxPositionZ,g=(0,c.pG)("scene.elements.terrain.hillForeground").rotationXOffset,b=V(r,t),v=(0,s.useMemo)((function(){return(0,G.Z)(Array(b)).map((function(){var e=x(u,o),t=x(h,a),r=x(f,l);return{x:e,y:t,z:r,resetX:u,percentOfMaxZ:(f-r)/(f-l)}}))}),[b,u,o,h,a,f,l]);return(0,d.tZ)(d.HY,{children:(0,n.Z)("group",{rotation:[g,0,0]},void 0,v.map((function(e,t){return(0,d.tZ)(F,N({},N({key:t},e)))})))})},q=(r(6602),r(3740),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:5,c=1/3*(2*Math.PI),l=Math.atan2(a-o,s-n),u=l+c,h=u+c,f=function(e,t){return e*Math.cos(t)+r},p=function(e,t){return e*Math.sin(t)+i},d=Math.abs(p(t,u)),g=0;return[[f(e,l),p(e,l)+d],[f(t,u),g],[f(t,h),g]]}),Q=q(.9,.8315217391304347).map((function(e){var t=(0,y.Z)(e,2),r=t[0],i=t[1];return new E.Vector3(r,i,0)})),_=function(){var e=(0,y.Z)(Q,3),t=e[0],r=e[1],i=e[2],n=new E.BufferGeometry,o=[t,r,i],s=Float32Array.from(new Array(o.length).fill().flatMap((function(e,t){return o[t].toArray()})));return n.setAttribute("position",new E.BufferAttribute(s,3)),{triangleGeom:n}}().triangleGeom,U=s.forwardRef((function(e,t){var r=e.isFirefly,i=(0,f.pG)("scene.elements.butterflys.butterfly.trail"),o=i.shrinkSpeed,a=i.particleNum,c=i.particleGap,l=i.particleYOffset,h=i.particleSize,p=i.cutoffOffset,g=a*c-p,b=(0,G.Z)(Array(a)).map(s.useRef);return(0,u.xQ)((function(e){e.clock.getElapsedTime();var i=[],n=[],s=0,a=t.current.position,u=a.x,h=a.y,f=a.z;if(!(!u&&!h&&!f)){b.map((function(e){var t=e.current.scale.x,r=t>0,a=e.current.position,c=a.x,l=a.y,p=a.z;if(r){var d=function(e,t){var r=(0,y.Z)(e,3),i=r[0],n=r[1],o=r[2],s=void 0===o?0:o,a=(0,y.Z)(t,3),c=a[0],l=a[1],u=a[2],h=i-c,f=n-l,p=s-(void 0===u?0:u);return Math.sqrt(h*h+f*f+p*p)}([c,l,p],[u,h,f]);(!!!s||d<s)&&(s=d),(t<1||d>g)&&(e.current.scale.x-=o,e.current.scale.y-=o,e.current.scale.z-=o),i.push(e)}else n.push(e)}));var p=!(0!==i.length)||s>c;if(!!n.length&&p){var d=n.shift(),v=r?0:l;d.current.position.x=u,d.current.position.y=h-v,d.current.position.z=f,d.current.scale.x=1,d.current.scale.y=1,d.current.scale.z=1}}})),(0,d.tZ)(d.HY,{children:b.map((function(e,t){return(0,d.tZ)(S.aL,{args:[h,20,20],ref:e,scale:[0,0,0],children:I||(I=(0,n.Z)("meshBasicMaterial",{attach:"material",color:"white"}))},t)}))})})),$=function(e){var t=e.isFirefly,r=void 0!==t&&t,i=e.i,o=void 0===i?0:i,a=(0,f.pG)("scene.elements.butterflys.butterfly.firefly"),c=a.size,l=a.color,h=a.lightDistance,p=a.triggeredLightIntensity,g=a.baseLightIntensity,b=a.baseScale,v=a.scalingSpeed,y=a.scalingScale,m=a.chanceToTrigger,x=a.delay,w=(0,s.useRef)();(0,u.xQ)((function(e){if(r){var t=e.clock.getElapsedTime()+x*o,i=w.current.scale.x!==b,n=Math.random()>1-m;(i||n)&&s()}function s(){var e=Math.sin(t*v)*y,r=Math.max(0,e),i=b+r,n=g+p*r;w.current.scale.x=i,w.current.scale.y=i,w.current.scale.z=i,w.current.intensity=n}}));var R=r?g:0,P=r?b:0;return(0,d.tZ)("pointLight",{ref:w,args:[l,R,h],scale:[P,P,P],children:(0,n.Z)(S.aL,{args:[c,20,20]},void 0,(0,n.Z)("meshBasicMaterial",{attach:"material",color:l}))})};function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){(0,P.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var te=function(e){var t=e.scale,r=void 0===t?1:t,i=e.percentage,o=void 0===i?1:i,a=e.delay,l=void 0===a?0:a,h=e.i,f=void 0===h?0:h,p=e.position,b=(0,g.Z)(e,["scale","percentage","delay","i","position"]),v=(0,c.pG)("scene.elements.butterflys.butterfly.settings"),m=v.rotationZ,x=v.rotationX,w=v.flapSpeed,R=v.flapScale,P=v.flightYScale,Z=v.flightYSpeed,S=v.flightHorizontalSpeed,O=v.flightHorizontalScale,k=v.clockwise,M=v.circle,z=v.debug,j=v.color,D=v.wingWidth,L=(0,y.Z)(p,3),C=(L[0],L[1],L[2]),B=(0,s.useMemo)((function(){var e=.01*Math.abs(C),t=e>.1;return[(0,T._j)(e,j),e,t]}),[j,C]),X=B[0],Y=(B[1],B[2]),G=(0,s.useMemo)((function(){return o>.5}),[o]),V=(0,s.useRef)(),H=(0,s.useRef)(),N=(0,s.useRef)();(0,u.xQ)((function(e){var t=e.clock.getElapsedTime()+l*f,r=t*w,i=t*Z,n=t*S,o=Math.sin(n),s=Math.cos(n),a=s*O,c=o*O,u=Math.sin(r)*R,h=Math.sin(i)*P,p={positionZ:{circle:{clockwise:a,anticlockwise:c},infinite:{clockwise:c,anticlockwise:a}},positionX:{circle:{clockwise:c,anticlockwise:a},infinite:{clockwise:c,anticlockwise:a}},rotationY:{circle:{clockwise:s,anticlockwise:o},infinite:{clockwise:s,anticlockwise:-s}}},d=M?"circle":"infinite",g=k?"clockwise":"anticlockwise",b=p.positionX[d][g],v=p.positionZ[d][g],y=p.rotationY[d][g];V.current.rotation.z=u,H.current.rotation.z=-u,N.current.position.y=h,N.current.position.x=b,N.current.position.z=v,N.current.rotation.y=y}));var A=G?0:1,I=(0,n.Z)("meshBasicMaterial",{fog:!1,color:z?"red":X,attach:"material",side:E.DoubleSide});return(0,d.tZ)(d.HY,{children:(0,d.BX)("group",ee(ee({},ee({position:p},b)),{},{children:[(0,d.BX)("group",{ref:N,scale:[r,r,r],rotation:[x,0,0],children:[(0,d.BX)(d.HY,{children:[(0,d.tZ)("group",{ref:V,scale:[A,A,A],rotation:[0,0,-m],children:(0,n.Z)("mesh",{rotation:[Math.PI/2,0,-Math.PI/2],position:[-D,0,0],geometry:_},void 0,I)}),(0,d.tZ)("group",{ref:H,scale:[A,A,A],rotation:[0,0,m],children:(0,n.Z)("mesh",{rotation:[Math.PI/2,0,Math.PI/2],position:[D,0,0],geometry:_},void 0,I)})]}),(0,n.Z)($,{isFirefly:G,i:f})]}),!Y&&(0,d.tZ)(U,{isFirefly:G,ref:N})]}))})},re=function(e){e.speed;var t=e.percentage,r=(0,c.pG)("scene.elements.butterflys.settings"),i=r.num,o=r.minPositionX,a=r.minPositionY,l=r.minPositionZ,u=r.maxPositionX,h=r.maxPositionY,f=r.maxPositionZ,p=r.minDelay,d=r.maxDelay,g=r.scale,b=r.debug,v=(0,c.pG)("scene.elements.terrain.hillForeground").rotationXOffset,y=(0,s.useMemo)((function(){return(0,G.Z)(Array(i)).map((function(){return{x:x(u,o),y:x(h,a),z:x(f,l),delay:R(d,p)}}))}),[i,u,o,h,a,f,l,d,p]);return(0,n.Z)("group",{rotation:[v,0,0]},void 0,y.map((function(e,r){var i=e.x,o=e.y,s=e.z,a=e.delay;return(0,n.Z)(te,{i:r,percentage:t,scale:g,position:[i,o,s],delay:a},r)})),b&&(0,n.Z)(te,{scale:.2,speed:.8,position:[0,0,0]}))},ie=r(21);function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach((function(t){(0,P.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var se=new(r.n(ie)())(Math.random),ae=function(e){var t=e.positionX,r=e.positionY,i=e.positionZ,n=e.rotationXOffset,o=e.color,a=e.segments,c=e.xyCoef,l=e.zCoef,u=e.sizeWidth,h=e.sizeLength,f=e.size,p=void 0===f?0:f,d=e.gap,g=void 0===d?0:d,b=e.sizeDelta,v=void 0===b?0:b,y=e.i,m=void 0===y?0:y,x=(0,s.useRef)(),w=(0,s.useState)(),R=w[0],P=w[1],Z=[t,r+g*m,i],E=[-Math.PI/2+n,0,0],S=p-v*m,O=S/2,k=o,M=[h||S,u||S,a,a];return(0,s.useEffect)((function(){for(var e=x.current.geometry.attributes.position.array,t=2e-4*Date.now(),r=0;r<e.length;r+=3){var i=se.noise4D(e[r]/c,e[r+1]/c,t,0);e[r+2]=i*l}x.current.geometry.attributes.position.needsUpdate=!0,P(!0)}),[c,l,a,o,p,u,h]),{plane:x,planeArgs:M,created:R,hillPosition:Z,hillRotation:E,hillColor:k,hillSize:S,hillRadius:O}},ce=function(e){var t=e.plane,r=e.planeArgs,i=e.hillColor,o=e.hillRotation,s=e.hillPosition;return(0,d.tZ)(d.HY,{children:(0,d.BX)("mesh",{ref:t,rotation:o,position:s,receiveShadow:!0,children:[(0,n.Z)("planeBufferGeometry",{args:r,attach:"geometry"}),(0,n.Z)("meshLambertMaterial",{attach:"material",color:i,side:E.DoubleSide})]})})},le=function(){var e=(0,f.pG)("scene.elements.terrain.hillForeground"),t=(0,f.pG)("scene.elements.terrain.hillBackground"),r=ae(e),i=ae(t);return(0,d.BX)(d.HY,{children:[(0,d.tZ)(ce,oe({},r)),(0,d.tZ)(ce,oe({},i))]})},ue=r(5062);r(4967);function he(){this.vertices=null,this.edges=null,this.cells=null,this.toRecycle=null,this.beachsectionJunkyard=[],this.circleEventJunkyard=[],this.vertexJunkyard=[],this.edgeJunkyard=[],this.cellJunkyard=[]}he.prototype.reset=function(){if(this.beachline||(this.beachline=new this.RBTree),this.beachline.root)for(var e=this.beachline.getFirst(this.beachline.root);e;)this.beachsectionJunkyard.push(e),e=e.rbNext;this.beachline.root=null,this.circleEvents||(this.circleEvents=new this.RBTree),this.circleEvents.root=this.firstCircleEvent=null,this.vertices=[],this.edges=[],this.cells=[]},he.prototype.sqrt=Math.sqrt,he.prototype.abs=Math.abs,he.prototype.\u03b5=he.\u03b5=1e-9,he.prototype.inv\u03b5=he.inv\u03b5=1/he.\u03b5,he.prototype.equalWithEpsilon=function(e,t){return this.abs(e-t)<1e-9},he.prototype.greaterThanWithEpsilon=function(e,t){return e-t>1e-9},he.prototype.greaterThanOrEqualWithEpsilon=function(e,t){return t-e<1e-9},he.prototype.lessThanWithEpsilon=function(e,t){return t-e>1e-9},he.prototype.lessThanOrEqualWithEpsilon=function(e,t){return e-t<1e-9},he.prototype.RBTree=function(){this.root=null},he.prototype.RBTree.prototype.rbInsertSuccessor=function(e,t){var r,i,n;if(e){if(t.rbPrevious=e,t.rbNext=e.rbNext,e.rbNext&&(e.rbNext.rbPrevious=t),e.rbNext=t,e.rbRight){for(e=e.rbRight;e.rbLeft;)e=e.rbLeft;e.rbLeft=t}else e.rbRight=t;r=e}else this.root?(e=this.getFirst(this.root),t.rbPrevious=null,t.rbNext=e,e.rbPrevious=t,e.rbLeft=t,r=e):(t.rbPrevious=t.rbNext=null,this.root=t,r=null);for(t.rbLeft=t.rbRight=null,t.rbParent=r,t.rbRed=!0,e=t;r&&r.rbRed;)r===(i=r.rbParent).rbLeft?(n=i.rbRight)&&n.rbRed?(r.rbRed=n.rbRed=!1,i.rbRed=!0,e=i):(e===r.rbRight&&(this.rbRotateLeft(r),r=(e=r).rbParent),r.rbRed=!1,i.rbRed=!0,this.rbRotateRight(i)):(n=i.rbLeft)&&n.rbRed?(r.rbRed=n.rbRed=!1,i.rbRed=!0,e=i):(e===r.rbLeft&&(this.rbRotateRight(r),r=(e=r).rbParent),r.rbRed=!1,i.rbRed=!0,this.rbRotateLeft(i)),r=e.rbParent;this.root.rbRed=!1},he.prototype.RBTree.prototype.rbRemoveNode=function(e){e.rbNext&&(e.rbNext.rbPrevious=e.rbPrevious),e.rbPrevious&&(e.rbPrevious.rbNext=e.rbNext),e.rbNext=e.rbPrevious=null;var t,r,i=e.rbParent,n=e.rbLeft,o=e.rbRight;if(t=n?o?this.getFirst(o):n:o,i?i.rbLeft===e?i.rbLeft=t:i.rbRight=t:this.root=t,n&&o?(r=t.rbRed,t.rbRed=e.rbRed,t.rbLeft=n,n.rbParent=t,t!==o?(i=t.rbParent,t.rbParent=e.rbParent,e=t.rbRight,i.rbLeft=e,t.rbRight=o,o.rbParent=t):(t.rbParent=i,i=t,e=t.rbRight)):(r=e.rbRed,e=t),e&&(e.rbParent=i),!r)if(e&&e.rbRed)e.rbRed=!1;else{var s;do{if(e===this.root)break;if(e===i.rbLeft){if((s=i.rbRight).rbRed&&(s.rbRed=!1,i.rbRed=!0,this.rbRotateLeft(i),s=i.rbRight),s.rbLeft&&s.rbLeft.rbRed||s.rbRight&&s.rbRight.rbRed){s.rbRight&&s.rbRight.rbRed||(s.rbLeft.rbRed=!1,s.rbRed=!0,this.rbRotateRight(s),s=i.rbRight),s.rbRed=i.rbRed,i.rbRed=s.rbRight.rbRed=!1,this.rbRotateLeft(i),e=this.root;break}}else if((s=i.rbLeft).rbRed&&(s.rbRed=!1,i.rbRed=!0,this.rbRotateRight(i),s=i.rbLeft),s.rbLeft&&s.rbLeft.rbRed||s.rbRight&&s.rbRight.rbRed){s.rbLeft&&s.rbLeft.rbRed||(s.rbRight.rbRed=!1,s.rbRed=!0,this.rbRotateLeft(s),s=i.rbLeft),s.rbRed=i.rbRed,i.rbRed=s.rbLeft.rbRed=!1,this.rbRotateRight(i),e=this.root;break}s.rbRed=!0,e=i,i=i.rbParent}while(!e.rbRed);e&&(e.rbRed=!1)}},he.prototype.RBTree.prototype.rbRotateLeft=function(e){var t=e,r=e.rbRight,i=t.rbParent;i?i.rbLeft===t?i.rbLeft=r:i.rbRight=r:this.root=r,r.rbParent=i,t.rbParent=r,t.rbRight=r.rbLeft,t.rbRight&&(t.rbRight.rbParent=t),r.rbLeft=t},he.prototype.RBTree.prototype.rbRotateRight=function(e){var t=e,r=e.rbLeft,i=t.rbParent;i?i.rbLeft===t?i.rbLeft=r:i.rbRight=r:this.root=r,r.rbParent=i,t.rbParent=r,t.rbLeft=r.rbRight,t.rbLeft&&(t.rbLeft.rbParent=t),r.rbRight=t},he.prototype.RBTree.prototype.getFirst=function(e){for(;e.rbLeft;)e=e.rbLeft;return e},he.prototype.RBTree.prototype.getLast=function(e){for(;e.rbRight;)e=e.rbRight;return e},he.prototype.Diagram=function(e){this.site=e},he.prototype.Cell=function(e){this.site=e,this.halfedges=[],this.closeMe=!1},he.prototype.Cell.prototype.init=function(e){return this.site=e,this.halfedges=[],this.closeMe=!1,this},he.prototype.createCell=function(e){var t=this.cellJunkyard.pop();return t?t.init(e):new this.Cell(e)},he.prototype.Cell.prototype.prepareHalfedges=function(){for(var e,t=this.halfedges,r=t.length;r--;)(e=t[r].edge).vb&&e.va||t.splice(r,1);return t.sort((function(e,t){return t.angle-e.angle})),t.length},he.prototype.Cell.prototype.getNeighborIds=function(){for(var e,t=[],r=this.halfedges.length;r--;)null!==(e=this.halfedges[r].edge).lSite&&e.lSite.voronoiId!=this.site.voronoiId?t.push(e.lSite.voronoiId):null!==e.rSite&&e.rSite.voronoiId!=this.site.voronoiId&&t.push(e.rSite.voronoiId);return t},he.prototype.Cell.prototype.getBbox=function(){for(var e,t,r,i=this.halfedges,n=i.length,o=1/0,s=1/0,a=-1/0,c=-1/0;n--;)(t=(e=i[n].getStartpoint()).x)<o&&(o=t),(r=e.y)<s&&(s=r),t>a&&(a=t),r>c&&(c=r);return{x:o,y:s,width:a-o,height:c-s}},he.prototype.Cell.prototype.pointIntersection=function(e,t){for(var r,i,n,o,s=this.halfedges,a=s.length;a--;){if(i=(r=s[a]).getStartpoint(),n=r.getEndpoint(),!(o=(t-i.y)*(n.x-i.x)-(e-i.x)*(n.y-i.y)))return 0;if(o>0)return-1}return 1},he.prototype.Vertex=function(e,t){this.x=e,this.y=t},he.prototype.Edge=function(e,t){this.lSite=e,this.rSite=t,this.va=this.vb=null},he.prototype.Halfedge=function(e,t,r){if(this.site=t,this.edge=e,r)this.angle=Math.atan2(r.y-t.y,r.x-t.x);else{var i=e.va,n=e.vb;this.angle=e.lSite===t?Math.atan2(n.x-i.x,i.y-n.y):Math.atan2(i.x-n.x,n.y-i.y)}},he.prototype.createHalfedge=function(e,t,r){return new this.Halfedge(e,t,r)},he.prototype.Halfedge.prototype.getStartpoint=function(){return this.edge.lSite===this.site?this.edge.va:this.edge.vb},he.prototype.Halfedge.prototype.getEndpoint=function(){return this.edge.lSite===this.site?this.edge.vb:this.edge.va},he.prototype.createVertex=function(e,t){var r=this.vertexJunkyard.pop();return r?(r.x=e,r.y=t):r=new this.Vertex(e,t),this.vertices.push(r),r},he.prototype.createEdge=function(e,t,r,i){var n=this.edgeJunkyard.pop();return n?(n.lSite=e,n.rSite=t,n.va=n.vb=null):n=new this.Edge(e,t),this.edges.push(n),r&&this.setEdgeStartpoint(n,e,t,r),i&&this.setEdgeEndpoint(n,e,t,i),this.cells[e.voronoiId].halfedges.push(this.createHalfedge(n,e,t)),this.cells[t.voronoiId].halfedges.push(this.createHalfedge(n,t,e)),n},he.prototype.createBorderEdge=function(e,t,r){var i=this.edgeJunkyard.pop();return i?(i.lSite=e,i.rSite=null):i=new this.Edge(e,null),i.va=t,i.vb=r,this.edges.push(i),i},he.prototype.setEdgeStartpoint=function(e,t,r,i){e.va||e.vb?e.lSite===r?e.vb=i:e.va=i:(e.va=i,e.lSite=t,e.rSite=r)},he.prototype.setEdgeEndpoint=function(e,t,r,i){this.setEdgeStartpoint(e,r,t,i)},he.prototype.Beachsection=function(){},he.prototype.createBeachsection=function(e){var t=this.beachsectionJunkyard.pop();return t||(t=new this.Beachsection),t.site=e,t},he.prototype.leftBreakPoint=function(e,t){var r=e.site,i=r.x,n=r.y,o=n-t;if(!o)return i;var s=e.rbPrevious;if(!s)return-1/0;var a=(r=s.site).x,c=r.y,l=c-t;if(!l)return a;var u=a-i,h=1/o-1/l,f=u/l;return h?(-f+this.sqrt(f*f-2*h*(u*u/(-2*l)-c+l/2+n-o/2)))/h+i:(i+a)/2},he.prototype.rightBreakPoint=function(e,t){var r=e.rbNext;if(r)return this.leftBreakPoint(r,t);var i=e.site;return i.y===t?i.x:1/0},he.prototype.detachBeachsection=function(e){this.detachCircleEvent(e),this.beachline.rbRemoveNode(e),this.beachsectionJunkyard.push(e)},he.prototype.removeBeachsection=function(e){var t=e.circleEvent,r=t.x,i=t.ycenter,n=this.createVertex(r,i),o=e.rbPrevious,s=e.rbNext,a=[e],c=Math.abs;this.detachBeachsection(e);for(var l=o;l.circleEvent&&c(r-l.circleEvent.x)<1e-9&&c(i-l.circleEvent.ycenter)<1e-9;)o=l.rbPrevious,a.unshift(l),this.detachBeachsection(l),l=o;a.unshift(l),this.detachCircleEvent(l);for(var u=s;u.circleEvent&&c(r-u.circleEvent.x)<1e-9&&c(i-u.circleEvent.ycenter)<1e-9;)s=u.rbNext,a.push(u),this.detachBeachsection(u),u=s;a.push(u),this.detachCircleEvent(u);var h,f=a.length;for(h=1;h<f;h++)u=a[h],l=a[h-1],this.setEdgeStartpoint(u.edge,l.site,u.site,n);l=a[0],(u=a[f-1]).edge=this.createEdge(l.site,u.site,void 0,n),this.attachCircleEvent(l),this.attachCircleEvent(u)},he.prototype.addBeachsection=function(e){for(var t,r,i,n,o=e.x,s=e.y,a=this.beachline.root;a;)if((i=this.leftBreakPoint(a,s)-o)>1e-9)a=a.rbLeft;else{if(!((n=o-this.rightBreakPoint(a,s))>1e-9)){i>-1e-9?(t=a.rbPrevious,r=a):n>-1e-9?(t=a,r=a.rbNext):t=r=a;break}if(!a.rbRight){t=a;break}a=a.rbRight}var c=this.createBeachsection(e);if(this.beachline.rbInsertSuccessor(t,c),t||r){if(t===r)return this.detachCircleEvent(t),r=this.createBeachsection(t.site),this.beachline.rbInsertSuccessor(c,r),c.edge=r.edge=this.createEdge(t.site,c.site),this.attachCircleEvent(t),void this.attachCircleEvent(r);if(!t||r){if(t!==r){this.detachCircleEvent(t),this.detachCircleEvent(r);var l=t.site,u=l.x,h=l.y,f=e.x-u,p=e.y-h,d=r.site,g=d.x-u,b=d.y-h,v=2*(f*b-p*g),y=f*f+p*p,m=g*g+b*b,x=this.createVertex((b*y-p*m)/v+u,(f*m-g*y)/v+h);return this.setEdgeStartpoint(r.edge,l,d,x),c.edge=this.createEdge(l,e,void 0,x),r.edge=this.createEdge(e,d,void 0,x),this.attachCircleEvent(t),void this.attachCircleEvent(r)}}else c.edge=this.createEdge(t.site,c.site)}},he.prototype.CircleEvent=function(){this.arc=null,this.rbLeft=null,this.rbNext=null,this.rbParent=null,this.rbPrevious=null,this.rbRed=!1,this.rbRight=null,this.site=null,this.x=this.y=this.ycenter=0},he.prototype.attachCircleEvent=function(e){var t=e.rbPrevious,r=e.rbNext;if(t&&r){var i=t.site,n=e.site,o=r.site;if(i!==o){var s=n.x,a=n.y,c=i.x-s,l=i.y-a,u=o.x-s,h=o.y-a,f=2*(c*h-l*u);if(!(f>=-2e-12)){var p=c*c+l*l,d=u*u+h*h,g=(h*p-l*d)/f,b=(c*d-u*p)/f,v=b+a,y=this.circleEventJunkyard.pop();y||(y=new this.CircleEvent),y.arc=e,y.site=n,y.x=g+s,y.y=v+this.sqrt(g*g+b*b),y.ycenter=v,e.circleEvent=y;for(var m=null,x=this.circleEvents.root;x;)if(y.y<x.y||y.y===x.y&&y.x<=x.x){if(!x.rbLeft){m=x.rbPrevious;break}x=x.rbLeft}else{if(!x.rbRight){m=x;break}x=x.rbRight}this.circleEvents.rbInsertSuccessor(m,y),m||(this.firstCircleEvent=y)}}}},he.prototype.detachCircleEvent=function(e){var t=e.circleEvent;t&&(t.rbPrevious||(this.firstCircleEvent=t.rbNext),this.circleEvents.rbRemoveNode(t),this.circleEventJunkyard.push(t),e.circleEvent=null)},he.prototype.connectEdge=function(e,t){var r=e.vb;if(r)return!0;var i,n,o=e.va,s=t.xl,a=t.xr,c=t.yt,l=t.yb,u=e.lSite,h=e.rSite,f=u.x,p=u.y,d=h.x,g=h.y,b=(f+d)/2,v=(p+g)/2;if(this.cells[u.voronoiId].closeMe=!0,this.cells[h.voronoiId].closeMe=!0,g!==p&&(n=v-(i=(f-d)/(g-p))*b),void 0===i){if(b<s||b>=a)return!1;if(f>d){if(!o||o.y<c)o=this.createVertex(b,c);else if(o.y>=l)return!1;r=this.createVertex(b,l)}else{if(!o||o.y>l)o=this.createVertex(b,l);else if(o.y<c)return!1;r=this.createVertex(b,c)}}else if(i<-1||i>1)if(f>d){if(!o||o.y<c)o=this.createVertex((c-n)/i,c);else if(o.y>=l)return!1;r=this.createVertex((l-n)/i,l)}else{if(!o||o.y>l)o=this.createVertex((l-n)/i,l);else if(o.y<c)return!1;r=this.createVertex((c-n)/i,c)}else if(p<g){if(!o||o.x<s)o=this.createVertex(s,i*s+n);else if(o.x>=a)return!1;r=this.createVertex(a,i*a+n)}else{if(!o||o.x>a)o=this.createVertex(a,i*a+n);else if(o.x<s)return!1;r=this.createVertex(s,i*s+n)}return e.va=o,e.vb=r,!0},he.prototype.clipEdge=function(e,t){var r=e.va.x,i=e.va.y,n=0,o=1,s=e.vb.x-r,a=e.vb.y-i,c=r-t.xl;if(0===s&&c<0)return!1;var l=-c/s;if(s<0){if(l<n)return!1;l<o&&(o=l)}else if(s>0){if(l>o)return!1;l>n&&(n=l)}if(c=t.xr-r,0===s&&c<0)return!1;if(l=c/s,s<0){if(l>o)return!1;l>n&&(n=l)}else if(s>0){if(l<n)return!1;l<o&&(o=l)}if(c=i-t.yt,0===a&&c<0)return!1;if(l=-c/a,a<0){if(l<n)return!1;l<o&&(o=l)}else if(a>0){if(l>o)return!1;l>n&&(n=l)}if(c=t.yb-i,0===a&&c<0)return!1;if(l=c/a,a<0){if(l>o)return!1;l>n&&(n=l)}else if(a>0){if(l<n)return!1;l<o&&(o=l)}return n>0&&(e.va=this.createVertex(r+n*s,i+n*a)),o<1&&(e.vb=this.createVertex(r+o*s,i+o*a)),(n>0||o<1)&&(this.cells[e.lSite.voronoiId].closeMe=!0,this.cells[e.rSite.voronoiId].closeMe=!0),!0},he.prototype.clipEdges=function(e){for(var t,r=this.edges,i=r.length,n=Math.abs;i--;)t=r[i],(!this.connectEdge(t,e)||!this.clipEdge(t,e)||n(t.va.x-t.vb.x)<1e-9&&n(t.va.y-t.vb.y)<1e-9)&&(t.va=t.vb=null,r.splice(i,1))},he.prototype.closeCells=function(e){for(var t,r,i,n,o,s,a,c,l,u=e.xl,h=e.xr,f=e.yt,p=e.yb,d=this.cells,g=d.length,b=Math.abs;g--;)if((t=d[g]).prepareHalfedges()&&t.closeMe){for(n=(i=t.halfedges).length,r=0;r<n;){if(s=i[r].getEndpoint(),c=i[(r+1)%n].getStartpoint(),b(s.x-c.x)>=1e-9||b(s.y-c.y)>=1e-9)switch(!0){case this.equalWithEpsilon(s.x,u)&&this.lessThanWithEpsilon(s.y,p):if(l=this.equalWithEpsilon(c.x,u),a=this.createVertex(u,l?c.y:p),o=this.createBorderEdge(t.site,s,a),r++,i.splice(r,0,this.createHalfedge(o,t.site,null)),n++,l)break;s=a;case this.equalWithEpsilon(s.y,p)&&this.lessThanWithEpsilon(s.x,h):if(l=this.equalWithEpsilon(c.y,p),a=this.createVertex(l?c.x:h,p),o=this.createBorderEdge(t.site,s,a),r++,i.splice(r,0,this.createHalfedge(o,t.site,null)),n++,l)break;s=a;case this.equalWithEpsilon(s.x,h)&&this.greaterThanWithEpsilon(s.y,f):if(l=this.equalWithEpsilon(c.x,h),a=this.createVertex(h,l?c.y:f),o=this.createBorderEdge(t.site,s,a),r++,i.splice(r,0,this.createHalfedge(o,t.site,null)),n++,l)break;s=a;case this.equalWithEpsilon(s.y,f)&&this.greaterThanWithEpsilon(s.x,u):if(l=this.equalWithEpsilon(c.y,f),a=this.createVertex(l?c.x:u,f),o=this.createBorderEdge(t.site,s,a),r++,i.splice(r,0,this.createHalfedge(o,t.site,null)),n++,l)break;if(s=a,l=this.equalWithEpsilon(c.x,u),a=this.createVertex(u,l?c.y:p),o=this.createBorderEdge(t.site,s,a),r++,i.splice(r,0,this.createHalfedge(o,t.site,null)),n++,l)break;if(s=a,l=this.equalWithEpsilon(c.y,p),a=this.createVertex(l?c.x:h,p),o=this.createBorderEdge(t.site,s,a),r++,i.splice(r,0,this.createHalfedge(o,t.site,null)),n++,l)break;if(s=a,l=this.equalWithEpsilon(c.x,h),a=this.createVertex(h,l?c.y:f),o=this.createBorderEdge(t.site,s,a),r++,i.splice(r,0,this.createHalfedge(o,t.site,null)),n++,l)break;default:throw"Voronoi.closeCells() > this makes no sense!"}r++}t.closeMe=!1}},he.prototype.quantizeSites=function(e){for(var t,r=this.\u03b5,i=e.length;i--;)(t=e[i]).x=Math.floor(t.x/r)*r,t.y=Math.floor(t.y/r)*r},he.prototype.recycle=function(e){if(e){if(!(e instanceof this.Diagram))throw"Voronoi.recycleDiagram() > Need a Diagram object.";this.toRecycle=e}},he.prototype.compute=function(e,t){var r=new Date;this.reset(),this.toRecycle&&(this.vertexJunkyard=this.vertexJunkyard.concat(this.toRecycle.vertices),this.edgeJunkyard=this.edgeJunkyard.concat(this.toRecycle.edges),this.cellJunkyard=this.cellJunkyard.concat(this.toRecycle.cells),this.toRecycle=null);var i=e.slice(0);i.sort((function(e,t){var r=t.y-e.y;return r||t.x-e.x}));for(var n,o,s,a=i.pop(),c=0,l=this.cells;;)if(s=this.firstCircleEvent,a&&(!s||a.y<s.y||a.y===s.y&&a.x<s.x))a.x===n&&a.y===o||(l[c]=this.createCell(a),a.voronoiId=c++,this.addBeachsection(a),o=a.y,n=a.x),a=i.pop();else{if(!s)break;this.removeBeachsection(s.arc)}this.clipEdges(t),this.closeCells(t);var u=new Date,h=new this.Diagram;return h.cells=this.cells,h.edges=this.edges,h.vertices=this.vertices,h.execTime=u.getTime()-r.getTime(),this.reset(),h};var fe=he,pe={sidewalk:{size:90,pieces:55,aspectRatio:.1,positionXOffset:0},voronoi:{extrudeSettings:{steps:2,depth:.4,bevelEnabled:!0,bevelThickness:.05,bevelSize:.01,bevelSegments:4},gap:.05,aestheticSiteOffset:0}},de=pe.sidewalk.size*pe.sidewalk.aspectRatio,ge=pe.sidewalk.size/2-de/2-pe.voronoi.aestheticSiteOffset/2+pe.sidewalk.positionXOffset,be=Math.PI/2,ve=(0,G.Z)(Array(pe.sidewalk.pieces)).map((function(e,t){return{x:Math.random()*pe.sidewalk.aspectRatio,y:Math.random()}})),ye=(new fe).compute(ve,{xl:0,xr:pe.sidewalk.aspectRatio,yt:0,yb:1}),me=-pe.sidewalk.size/2,xe=new E.Vector2(me,me);function we(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function Re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?we(Object(r),!0).forEach((function(t){(0,P.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):we(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Pe,Ze=2*Math.PI,Ee=function(e){var t=e.speed,r=(0,c.pG)("scene.elements.portal.portalScene.sidewalk"),i=r.baseZ,o=r.speedY,a=r.speedZ,l=r.positionZStart,h=r.positionYTriggerStart,f=r.positionYResetCutoff,p=-pe.sidewalk.size+f,g=i-l,b=Math.abs(g/a),v=Ze/b,y=(0,s.useMemo)((function(){var e=ye.cells.map((function(e,t){var r=e.site,i=r.x,n=r.y,o=pe.voronoi.aestheticSiteOffset-i,s=pe.voronoi.aestheticSiteOffset-n-t*pe.voronoi.gap,a=e.halfedges.map((function(e){var t=e.getStartpoint(),r=new E.Vector2;return r.copy(t),r.multiplyScalar(pe.sidewalk.size),r.add(xe),r})),c=new E.Shape(a);return{geometry:new E.ExtrudeGeometry(c,pe.voronoi.extrudeSettings),x:o,y:s}}));return(0,G.Z)(e)}),[]),m=y.map((function(){return{mesh:(0,s.useRef)(),group:(0,s.useRef)()}})),x=function(){m.map((function(e,r){var n=e.mesh,s=e.group,c=s.current.position.y,u=s.current.position.z,d=r%2===0,g=v*t,b=c>=f;c>=h&&(u<i&&(s.current.position.z+=a*t,n.current.rotation.x+=g,n.current.rotation.y+=d?g:-g,n.current.rotation.x>Ze&&(n.current.rotation.x=Ze,n.current.rotation.y=Ze)));if(b)return s.current.position.y=p,s.current.position.z=l,n.current.rotation.x=0,void(n.current.rotation.y=0);var y=c+o*t;s.current.position.y=y}))};return(0,u.xQ)(x),(0,s.useEffect)((function(){var e,t;m.map((function(e,t){var r=e.mesh,i=e.group,n=(new E.Box3).setFromObject(i.current),o=new E.Vector3,s=n.getCenter(o);r.current.geometry.center(),i.current.translateX(s.x),i.current.translateY(s.y),i.current.translateZ(s.z),i.current.position.z=l})),e=x,t=565,(0,G.Z)(Array(t)).map(e)}),[]),(0,n.Z)("group",{rotation:[be,0,0],position:[ge,-2,-20]},void 0,y.map((function(e,t){var r=e.geometry,i=(e.x,e.y),n=p-i;return(0,d.tZ)("group",{ref:m[t].group,position:[0,n,0],children:(0,d.tZ)("mesh",{castShadow:!0,receiveShadow:!0,ref:m[t].mesh,geometry:r,children:(0,d.tZ)("meshBasicMaterial",Re({},{attach:"material",color:"#d89ef4"}))})},t)})))},Se=r(1229);function Oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function ke(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(r),!0).forEach((function(t){(0,P.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Me=s.forwardRef((function(e,t){var r=(0,Se.Z)({},e),i=(0,s.useMemo)((function(){var e=new E.Shape;e.moveTo(0,.6),e.lineTo(.3,.3),e.lineTo(.2,0),e.lineTo(-.2,0),e.lineTo(-.3,.3),e.lineTo(0,.6);var t={depth:5.5*Math.random()+.7,bevelEnabled:!0,bevelSegments:1,steps:1,bevelSize:1*Math.random()+1.5,bevelThickness:1*Math.random()+2.5},r=new E.ExtrudeGeometry(e,t);return r.center(),r}),[]),o=Math.PI/2;return(0,d.tZ)("group",ke(ke({ref:t},r),{},{children:(0,n.Z)("mesh",{rotation:[o,0,0],geometry:i},void 0,Pe||(Pe=(0,n.Z)("meshBasicMaterial",{attach:"material",color:"#d89ef4"})))}))})),ze=function(e){var t=e.speed,r=void 0===t?1:t,i=(0,c.pG)("scene.elements.portal.portalScene.crystals"),n=i.num,o=i.maxPositionX,a=i.maxPositionY,l=i.maxPositionZ,h=i.minPositionX,f=i.minPositionY,p=i.minPositionZ,g=i.minRotationZ,b=i.maxRotationZ,v=i.minSize,y=i.maxSize,m=i.positionXExceptSize,R=i.positionZResetCutoff,P=i.positionZReset,Z=i.speed,E=(0,G.Z)(Array(n)).map((function(){return(0,s.useRef)()}));return(0,u.xQ)((function(){E.map((function(e){e.current&&(e.current.position.z>R?e.current.position.z=P:e.current.position.z+=Z*r)}))})),(0,s.useMemo)((function(){return E.map((function(e,t){var r=x(l,p),i=x(a,f),n=w(o,h,m,-m),s=x(b,g);return{ref:e,size:x(y,v),rotationZ:s,positionX:n,positionY:i,positionZ:r}}))}),[o,h,a,f,l,p,m,y,v]).map((function(e,t){var r=e.ref,i=e.size,n=e.positionX,o=e.positionY,s=e.positionZ,a=e.rotationZ;return(0,d.tZ)(Me,{ref:r,position:[n,o,s],rotation:[0,0,a],scale:[i,i,i]},t)}))},je=function(e){var t=1-e.percentage,r=(0,c.pG)("scene.elements.portal.portalScene.fog"),i=r.color,o=r.near,s=r.far,a=r.on,l=(0,c.pG)("scene.elements.portal.portalScene.state").speed,u=Math.max(l*t,-.1);return(0,d.BX)(d.HY,{children:[a&&(0,n.Z)("fog",{attach:"fog",args:[i,o,s]}),(0,n.Z)("pointLight",{castShadow:!0,penumbra:1,intensity:1,position:[0,2,0],"shadow-mapSize-width":256,"shadow-mapSize-height":256}),(0,n.Z)(Ee,{speed:u}),(0,n.Z)(ze,{speed:u})]})},De="Portal",Le="PortalScene";(0,p.QX)(De),(0,p.QX)(Le);var Ce,Be,Xe=function(e){var t=e.percentage,r=(e.speed,(0,s.useRef)()),i=(0,s.useRef)(),o=(0,c.pG)("scene.elements.portal.settings"),a=o.background,l=o.positionZ,h=o.positionY,f=o.cameraPositionX,g=o.cameraPositionY,b=o.cameraPositionZ,v=o.cameraLookAtX,y=o.cameraLookAtY,m=o.cameraLookAtZ,x=o.lightPositionZ,w=o.lightPositionY,R=o.lightColor,P=o.lightIntensity,Z=o.lightDistance,O=o.debug,k=(o.animationSpeedY,o.animationScaleY,(0,s.useState)(!1)),M=k[0],z=k[1],j=(0,p.d0)(De).additionalLoad,D=(0,s.useMemo)((function(){var e=new E.Scene,t=new E.WebGLRenderTarget(1024,1024),r=new E.PerspectiveCamera(45,1,.1,1e3);return r.position.x=f,r.position.y=g,r.position.z=b,e.add(r),e.background=new E.Color(a),r.lookAt(v,y,m),[e,t,r]}),[a]),L=D[0],C=D[1],B=D[2];(0,s.useEffect)((function(){B.position.x=f,B.position.y=g,B.position.z=b,B.lookAt(v,y,m),z(!0)}),[f,g,b,v,y,m]),(0,s.useEffect)((function(){M&&j(Le)}),[M]),(0,u.xQ)((function(e){e.gl.setRenderTarget(C),e.gl.render(L,B),e.gl.setRenderTarget(null),e.gl.autoClear=!1}));var X=(0,s.useRef)();return(0,ue.H)(X,E.PointLightHelper,R),(0,d.BX)(d.HY,{children:[(0,u.jz)((0,n.Z)(je,{percentage:t}),L),(0,d.BX)("group",{ref:i,position:[0,h,l],children:[(0,n.Z)("pointLight",{distance:Z,color:R,penumbra:1,intensity:P,position:[0,w,x],"shadow-mapSize-width":256,"shadow-mapSize-height":256},void 0,O&&(0,n.Z)(S.aL,{args:[.05,20,20]},void 0,(0,n.Z)("meshBasicMaterial",{attach:"material",color:R}))),(0,d.tZ)(S.JO,{args:[2,2],ref:r,castShadow:!0,receiveShadow:!0,children:(0,n.Z)("meshBasicMaterial",{attach:"material",map:C.texture,side:E.DoubleSide})})]})]})},Ye="Scene";(0,p.QX)(Ye);var Ge=function(e){var t=e.percentage;return(0,p.d0)(Ye),(0,d.BX)(d.HY,{children:[(0,n.Z)(Y,{percentage:t}),Ce||(Ce=(0,n.Z)(J,{})),Be||(Be=(0,n.Z)(le,{})),(0,n.Z)(Xe,{percentage:t}),(0,n.Z)(re,{percentage:t})]})},Te=(r(5365),r(9322));var Ve=(0,o.Z)("div",{target:"eewcu0o1"})({name:"f3bbid",styles:"position:fixed;left:0;right:0;bottom:0;top:0;z-index:-1"}),He=Te.PE+Te.xf,Ne=(0,o.Z)("div",{target:"eewcu0o0"})("position:absolute;top:0;bottom:0;right:0;left:0;background:","hsl(0, 0%, 31%)",";opacity:",Te.C_,";z-index:1;display:flex;align-items:center;justify-content:center;transition:opacity ",250,"ms ",He,"ms linear;"),Ae=function(e){var t=e.percentage,r=(0,h.j)(f._y,p._y),i=(0,p.$C)().loaded;return(0,n.Z)(Ve,{},void 0,(0,n.Z)(Ne,{visible:!i}),(0,n.Z)(u.Xz,{autoClear:!1,style:{height:"100vh",width:"100vw"},shadows:!0},void 0,(0,n.Z)(r,{},void 0,(0,n.Z)(Ge,{percentage:t}))))};var Ie=(0,o.Z)("div",{target:"e1vao26o0"})({name:"bjn8wh",styles:"position:relative"}),We="Background";(0,p.QX)(We);var Fe=function(){var e=l();return(0,p.d0)(We),(0,n.Z)(Ie,{},void 0,(0,n.Z)(Ae,{percentage:e}),(0,n.Z)(a.Zf,{theme:{sizes:{rootWidth:"600px",controlWidth:"350px"}}}))}},9322:function(e,t,r){"use strict";r.d(t,{XQ:function(){return i},C_:function(){return n},PE:function(){return o},$e:function(){return s},xf:function(){return a}});var i=2,n=function(e){return e.visible?1:0},o=450,s=100,a=100}}]);